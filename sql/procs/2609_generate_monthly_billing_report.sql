CREATE OR REPLACE PROCEDURE DOCGEN.GENERATE_MONTHLY_BILLING_REPORT(account_id STRING, report_month DATE)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
-- simple aggregation into LINE_ITEMS variant
INSERT INTO DOCGEN.MONTHLY_BILLING_REPORTS (REPORT_ID, ACCOUNT_ID, REPORT_MONTH, LINE_ITEMS)
SELECT UUID_STRING(), :account_id, :report_month, OBJECT_CONSTRUCT('summary', 'generated');
$$

