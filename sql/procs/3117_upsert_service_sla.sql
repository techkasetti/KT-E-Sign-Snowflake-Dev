CREATE OR REPLACE PROCEDURE DOCGEN.UPSERT_SERVICE_SLA(service_ref STRING, slo VARIANT)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
MERGE INTO DOCGEN.SERVICE_SLA t USING (SELECT :service_ref AS sr, :slo AS s) s ON t.SERVICE_REF = s.sr WHEN MATCHED THEN UPDATE SET SLO = s.s WHEN NOT MATCHED THEN INSERT (SLA_ID, SERVICE_REF, SLO) VALUES (UUID_STRING(), s.sr, s.s);
$$
