CREATE OR REPLACE PROCEDURE DOCGEN.EXPORT_SIGNATURES_BY_DATE(start_date TIMESTAMP_LTZ, end_date TIMESTAMP_LTZ)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
INSERT INTO DOCGEN.TEMP_FILES (TEMP_ID, PATH) SELECT UUID_STRING(), '/tmp/export_' || TO_VARCHAR(CURRENT_TIMESTAMP()) FROM DOCGEN.SIGNATURE_EVENTS WHERE EVENT_TS BETWEEN :start_date AND :end_date;
$$;

