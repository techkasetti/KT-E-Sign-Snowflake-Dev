CREATE OR REPLACE PROCEDURE DOCGEN.UPSERT_SLO_DEFINITION(slo_id STRING, name STRING, targets VARIANT, enabled BOOLEAN)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
MERGE INTO DOCGEN.SLO_DEFINITIONS t USING (SELECT :slo_id AS sid, :name AS nm, :targets AS tg, :enabled AS en) s ON t.SLO_ID = s.sid WHEN MATCHED THEN UPDATE SET NAME = s.nm, TARGETS = s.tg, ENABLED = s.en WHEN NOT MATCHED THEN INSERT (SLO_ID, NAME, TARGETS, ENABLED) VALUES (s.sid, s.nm, s.tg, s.en);
$$

