CREATE OR REPLACE PROCEDURE DOCGEN.UPSERT_OPS_RUNBOOK(name STRING, content CLOB)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
MERGE INTO DOCGEN.OPS_RUNBOOKS t USING (SELECT :name AS nm, :content AS ct) s ON t.NAME = s.nm WHEN MATCHED THEN UPDATE SET CONTENT = s.ct, UPDATED_AT = CURRENT_TIMESTAMP() WHEN NOT MATCHED THEN INSERT (RUNBOOK_ID, NAME, CONTENT) VALUES (UUID_STRING(), s.nm, s.ct);
$$
