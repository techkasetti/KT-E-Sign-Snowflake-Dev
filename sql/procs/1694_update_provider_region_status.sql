CREATE OR REPLACE PROCEDURE DOCGEN.UPDATE_PROVIDER_REGION_STATUS(pr_id STRING, status STRING)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
MERGE INTO DOCGEN.PROVIDER_REGION_STATUS t USING (SELECT :pr_id AS pid, :status AS st) s ON t.PR_ID = s.pid WHEN MATCHED THEN UPDATE SET STATUS = s.st, LAST_UPDATED = CURRENT_TIMESTAMP() WHEN NOT MATCHED THEN INSERT (PRS_ID, PR_ID, STATUS) VALUES (UUID_STRING(), s.pid, s.st);
$$;

