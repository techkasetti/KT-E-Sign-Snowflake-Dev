CREATE OR REPLACE PROCEDURE DOCGEN.UPSERT_SIMILARITY_CACHE_06(cache_id STRING, source_id STRING, target_id STRING, score FLOAT)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
MERGE INTO DOCGEN.CONTENT_SIMILARITY_CACHE_06 t USING (SELECT :cache_id AS cid, :source_id AS sid, :target_id AS tid, :score AS sc) s ON t.CACHE_ID = s.cid WHEN MATCHED THEN UPDATE SET SOURCE_ID = s.sid, TARGET_ID = s.tid, SCORE = s.sc WHEN NOT MATCHED THEN INSERT (CACHE_ID, SOURCE_ID, TARGET_ID, SCORE) VALUES (s.cid, s.sid, s.tid, s.sc);
$$
