CREATE OR REPLACE PROCEDURE DOCGEN.UPDATE_OPS_RUNBOOK_12(runbook_id STRING, name STRING, steps VARIANT, owner STRING)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
MERGE INTO DOCGEN.OPS_RUNBOOKS_12 t USING (SELECT :runbook_id AS rid, :name AS nm, :steps AS st, :owner AS ow) s
ON t.RUNBOOK_ID = s.rid
WHEN MATCHED THEN UPDATE SET NAME = s.nm, STEPS = s.st, OWNER = s.ow, UPDATED_AT = CURRENT_TIMESTAMP()
WHEN NOT MATCHED THEN INSERT (RUNBOOK_ID, NAME, STEPS, OWNER) VALUES (s.rid, s.nm, s.st, s.ow);
$$

