CREATE OR REPLACE PROCEDURE DOCGEN.UPSERT_SIGNATURE_META_05(meta_id STRING, bundle_id STRING, meta_key STRING, meta_value VARIANT)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
MERGE INTO DOCGEN.SIGNATURE_META_INDEX_05 t
USING (SELECT :meta_id AS mid, :bundle_id AS bid, :meta_key AS mk, :meta_value AS mv) s
ON t.META_ID = s.mid
WHEN MATCHED THEN UPDATE SET BUNDLE_ID = s.bid, META_KEY = s.mk, META_VALUE = s.mv
WHEN NOT MATCHED THEN INSERT (META_ID, BUNDLE_ID, META_KEY, META_VALUE) VALUES (s.mid, s.bid, s.mk, s.mv);
$$

