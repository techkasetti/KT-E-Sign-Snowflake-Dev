CREATE OR REPLACE PROCEDURE DOCGEN.UPSERT_SLA_DEFINITION(sla_id STRING, name STRING, objectives VARIANT, enabled BOOLEAN)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
MERGE INTO DOCGEN.SLA_DEFINITIONS t USING (SELECT :sla_id AS sid, :name AS nm, :objectives AS obj, :enabled AS en) s ON t.SLA_ID = s.sid WHEN MATCHED THEN UPDATE SET NAME = s.nm, OBJECTIVES = s.obj, ENABLED = s.en WHEN NOT MATCHED THEN INSERT (SLA_ID, NAME, OBJECTIVES, ENABLED) VALUES (s.sid, s.nm, s.obj, s.en);
$$

