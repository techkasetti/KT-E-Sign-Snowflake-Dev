CREATE OR REPLACE PROCEDURE DOCGEN.UPSERT_ADMIN_POLICY_12(policy_id STRING, name STRING, scope VARIANT, rules VARIANT, enabled BOOLEAN)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
MERGE INTO DOCGEN.ADMIN_POLICIES_12 t USING (SELECT :policy_id AS pid, :name AS nm, :scope AS scp, :rules AS r, :enabled AS e) s ON t.POLICY_ID = s.pid WHEN MATCHED THEN UPDATE SET NAME = s.nm, SCOPE = s.scp, RULES = s.r, ENABLED = s.e, UPDATED_AT = CURRENT_TIMESTAMP() WHEN NOT MATCHED THEN INSERT (POLICY_ID, NAME, SCOPE, RULES, ENABLED) VALUES (s.pid, s.nm, s.scp, s.r, s.e);
$$

