CREATE OR REPLACE PROCEDURE DOCGEN.MARK_OTP_USED_01(otp_id STRING, used_by STRING)
RETURNS VARIANT
LANGUAGE SQL
AS
$$
INSERT INTO DOCGEN.OTP_USES_01 (USE_ID, OTP_ID, USED_BY) VALUES (UUID_STRING(), :otp_id, :used_by);
UPDATE DOCGEN.OTPS_01 SET USED = TRUE WHERE OTP_ID = :otp_id;
$$

