USE DATABASE AI_FEATURE_HUB;
USE SCHEMA DOCGEN;
CREATE OR REPLACE MATERIALIZED VIEW DOCGEN.MV_PROVIDER_UPTIME AS SELECT PROVIDER_NAME, SUM(CASE WHEN STATUS='UP' THEN 1 ELSE 0 END)::INT / NULLIF(SUM(1),0) AS UPTIME_RATIO FROM DOCGEN.PROVIDER_STATUS GROUP BY PROVIDER_NAME;

