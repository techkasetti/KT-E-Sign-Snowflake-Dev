-- Certificate metadata store for signer certificate chains, with OCSP/CRL references for revocation checks. @12 @52
USE DATABASE AI_FEATURE_HUB;
USE SCHEMA DOCGEN;
CREATE OR REPLACE TABLE DOCGEN.SIGNATURE_CERTIFICATES (
  CERT_ID STRING PRIMARY KEY,
  SIGNER_ID STRING,
  CERT_CHAIN VARIANT,
  SERIAL_NUMBER STRING,
  ISSUER STRING,
  SUBJECT STRING,
  NOT_BEFORE TIMESTAMP_LTZ,
  NOT_AFTER TIMESTAMP_LTZ,
  OCSP_RESPONSE VARIANT,
  CRL_STATUS VARIANT,
  INGESTED_AT TIMESTAMP_LTZ DEFAULT CURRENT_TIMESTAMP()
);

