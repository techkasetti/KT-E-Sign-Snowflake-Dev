USE DATABASE AI_FEATURE_HUB; USE SCHEMA DOCGEN;
CREATE OR REPLACE MATERIALIZED VIEW DOCGEN.MV_SIGNATURE_AUDIT_SUMMARY AS
SELECT
  ACCOUNT_ID,
  COUNT(*) AS TOTAL_EVENTS,
  SUM(CASE WHEN ACTION = 'SIGN' THEN 1 ELSE 0 END) AS SIGN_COUNT,
  MAX(AUDIT_TS) AS LAST_AUDIT_AT
FROM DOCGEN.SIGNATURE_AUDIT_TRAIL
GROUP BY ACCOUNT_ID;
-- Materialized audit summary optimized for admin dashboards and SLA checks @15 @71

